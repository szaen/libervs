Sub Initialize
	Dim session As New NotesSession
	Dim dbServer As String
	Dim dbDirectory As String
	Dim copyDirectory As String
	
	dbServer = "NomeDoServidor" ' Substitua pelo nome do servidor
	dbDirectory = "C:\Caminho\Para\As\Bases" ' Substitua pelo diretório das bases de dados
	copyDirectory = "C:\Caminho\Para\Destino" ' Substitua pelo diretório de destino das cópias
	
	Dim db As NotesDatabase
	Set db = session.GetDatabase(dbServer, dbDirectory, False)
	
	If Not db Is Nothing Then
        ' Compacta o design do banco de dados
		Call db.Compact
		
		Dim options As Long
		options = FTINDEX_ATTACHED_FILES + FTINDEX_ALL_BREAKS
		
		Dim recreate As Boolean
		recreate = True
		
		Dim targetFilePath As String
		targetFilePath = copyDirectory & "\" & db.Title & ".nft"
		
        ' Cria um índice de texto completo para o banco de dados compactado
		Call db.CreateFTIndex(options, recreate)
		
		Msgbox "Índice de texto completo criado com sucesso!"
	Else
		Msgbox "Não foi possível acessar a base de dados."
	End If
End Sub
